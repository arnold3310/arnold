<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="google" content="notranslate" />
    
    <title>Project</title>
    
    <style>
        /* =========================================
           å­—é«”è¨­ç½®
           ========================================= */
        @font-face {
            font-family: "HanYiShangWei";
            src: url("æ±‰ä»ªå°šå·æ‰‹ä¹¦W.ttf") format("truetype");
            font-display: swap;
        }
        @font-face {
            font-family: "YuWei";
            src: url("ç¦¹å«ä¹¦æ³•è¡Œä¹¦ç®€ä½“.ttf") format("truetype");
            font-display: swap;
        }

        body {
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-image: url("å¤§æµ·.png");
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            margin: 0;
            overflow: hidden;
            background-color: #333; 
        }

        /* é®ç½©å±¤ */
        .overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.4); 
            pointer-events: none;
            z-index: 0;
        }

        /* è½‰å ´ç™½å…‰é®ç½© */
        #white-flash {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: white;
            z-index: 9999;
            opacity: 1;    
            pointer-events: none;
            transition: opacity 1.5s ease-out; 
        }

        /* ================== ä¿¡å°ä¸»é«” ================== */
        .card-wrapper {
            position: relative;
            z-index: 10;
            transform: scale(0.005); 
            filter: brightness(80) blur(10px) drop-shadow(0 0 80px white); 
            opacity: 1; 
        }
        
        .card-wrapper.materialized {
            transform: scale(1);
            filter: brightness(1) blur(0) drop-shadow(0 0 0 transparent);
            transition: transform 7s cubic-bezier(0.1, 0.9, 0.2, 1), filter 7s ease-out;
            animation: floatCard 3s ease-in-out infinite 7s; 
        }

        .card {
            width: 500px;
            height: 320px;
            background-color: #a3d2ee; 
            background-image: 
                url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.7' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.15'/%3E%3C/svg%3E"),
                linear-gradient(to bottom, rgba(255,255,255,0.2), rgba(0,0,0,0.05));
            border: 1px solid #7daec8;
            color: #555; 
            box-shadow: 0 0 30px rgba(163, 210, 238, 0.4), 0 20px 50px rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            position: relative;
            border-radius: 6px;
            transition: opacity 1s ease, transform 0.5s ease;
            user-select: none;
            -webkit-user-select: none;
            cursor: default; 
        }
        
        .card.interactive { cursor: pointer; }
        .card.interactive:hover {
            transform: scale(1.02);
            box-shadow: 0 0 40px rgba(163, 210, 238, 0.6), 0 25px 60px rgba(0,0,0,0.6);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 100%; height: 180px; 
            clip-path: polygon(0 0, 100% 0, 50% 100%);
            -webkit-clip-path: polygon(0 0, 100% 0, 50% 100%);
            background-color: #8dbcd8;
            background-image: linear-gradient(to bottom, rgba(255,255,255,0.1), rgba(0,0,0,0.1));
            z-index: 1; 
            transform-origin: top;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.2));
            transition: transform 2.5s ease-in-out, z-index 2.5s;
        }

        @keyframes floatCard {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        .text.envelope-msg {
            z-index: 10; position: absolute; top: 60px;
            font-family: 'Brush Script MT', cursive; 
            font-size: 2.8em; color: #fff; 
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2), 0 0 5px rgba(212, 175, 55, 0.8);
            transform: rotate(-4deg); letter-spacing: 2px; 
            pointer-events: none;
        }

        .heart {
            position: absolute; top: 155px; width: 50px; height: 50px;
            background: radial-gradient(circle at 30% 30%, #d35400, #a93226);
            border-radius: 50%;
            box-shadow: 0 3px 6px rgba(0,0,0,0.3);
            z-index: 20; border: 2px solid #922b21;
            display: flex; justify-content: center; align-items: center;
            transition: opacity 0.5s ease;
        }
        .heart::after { content: 'âœ‰'; color: #e6b0aa; font-size: 24px; }

        .click-hint {
            position: absolute; top: 220px; font-size: 14px;
            font-family: 'HanYiShangWei', 'YuWei', serif;
            color: #fff; letter-spacing: 2px; z-index: 25; pointer-events: none;
            text-shadow: 0 1px 3px rgba(0,0,0,0.4);
            animation: hintFloat 2s ease-in-out infinite;
            opacity: 0; transition: opacity 1s;
        }
        .click-hint.show { opacity: 1; }

        /* ================== ä¿¡ç´™å…§å®¹å€åŸŸ ================== */
        #box {
            position: absolute; left: 0; top: 0; width: 100vw; height: 100vh;
            z-index: -1; opacity: 0; 
            transition: opacity 2s ease-in-out; 
            display: flex; flex-direction: column; justify-content: flex-start; text-align: left;            
            padding: 12vh 18vw 10vh 18vw; 
            box-sizing: border-box;
            
            background-image: 
                url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.08'/%3E%3C/svg%3E"),
                radial-gradient(circle at center, rgba(0,0,0,0.3) 0%, rgba(0,0,0,0.8) 100%),
                url("å’–å•¡åº—.png"); 
            background-size: auto, cover, cover; background-position: 0 0, center, center; 
            background-color: #1a1a1a;
            
            /* çµ±ä¸€ç™½è‰²æ–‡å­—ï¼Œä¿æŒå­—é«”æ¸…æ™°åº¦ */
            color: rgba(255, 255, 255, 0.95);
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.9); 
            
            font-size: 32px; 
            font-weight: normal; 
            font-family: 'HanYiShangWei', 'YuWei', cursive;
            line-height: 2.0; 
            letter-spacing: 2px;
            
            overflow-y: auto; 
            scroll-behavior: smooth; 
            
            user-select: none; -webkit-user-select: none; cursor: default;
        }

        #box::-webkit-scrollbar { width: 6px; }
        #box::-webkit-scrollbar-thumb { background: rgba(255, 255, 255, 0.1); border-radius: 3px; }
        #box::-webkit-scrollbar-track { background: transparent; }

        #box p { 
            text-indent: 0; 
            margin: 0; 
            padding-bottom: 28px; 
        }
        
        .recipient-name {
            font-size: 1.2em;
            margin-bottom: 10px;
            display: block;
        }

        #box .right-align { 
            text-align: right; 
            margin-top: 20px;
        }

        .sparkle {
            position: absolute; border-radius: 50%; background: white;
            box-shadow: 0 0 10px #fff, 0 0 20px #a3d2ee; opacity: 0; pointer-events: none; z-index: 5; 
        }
        @keyframes sparkleFloat {
            0% { transform: translateY(0) scale(0); opacity: 0; }
            50% { opacity: 0.8; }
            100% { transform: translateY(-100px) scale(1.5); opacity: 0; }
        }

        .card.open::before { transform: rotateX(180deg); z-index: 0; }
        .card.open .text, .card.open .heart, .card.open .click-hint { opacity: 0; pointer-events: none; }
        .card.open { opacity: 0; pointer-events: none; transition-delay: 1.5s; }
        .card-wrapper.opening { animation: none; }

        .next-chapter-btn {
            display: inline-block; padding: 15px 60px; font-size: 26px;
            color: #fff; background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0));
            backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.4); border-radius: 50px;
            font-family: 'HanYiShangWei', cursive; letter-spacing: 3px; position: relative; overflow: hidden;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.1); transition: all 0.5s; cursor: pointer;
        }
        .next-chapter-btn:hover {
            background: linear-gradient(135deg, rgba(255,255,255,0.2), rgba(255,255,255,0.05));
            border-color: rgba(255,255,255,0.8); box-shadow: 0 0 30px rgba(255,255,255,0.4);
            transform: translateY(-3px) scale(1.02);
        }

    </style>
</head>

<body>
    <div id="white-flash"></div>
    <div class="overlay"></div>

    <div class="card-wrapper">
        <div class="card">
            <div class="text content envelope-msg">Best wishes</div>
            <div class="heart content"></div>
            <div class="click-hint">é»æ“Šé–‹å•Ÿ âœ¨</div>
        </div>
        <div id="sparkles-container"></div>
    </div>

    <div id="box"></div>

    <audio id="bgm" src="ç”Ÿæ—¥æ­Œçº¯é’¢ç´.mp3" autoplay="autoplay" loop="loop"></audio>
    <audio id="se-typing" src="typing.mp3" loop></audio>

    <script>
        let heart = document.querySelector('.heart')
        let card = document.querySelector('.card')
        let wrapper = document.querySelector('.card-wrapper')
        let box = document.querySelector('#box')
        let sparkleContainer = document.querySelector('#sparkles-container')
        let whiteFlash = document.getElementById('white-flash');
        let clickHint = document.querySelector('.click-hint');
        let typingSound = document.getElementById('se-typing');
        let bgm = document.getElementById('bgm');
        let canOpen = false;

        window.onload = function() {
            setTimeout(() => { whiteFlash.style.opacity = 0; }, 100); 
            setTimeout(() => { wrapper.classList.add('materialized'); }, 500); 
            setTimeout(() => { whiteFlash.style.display = 'none'; }, 2000);
            setTimeout(() => { canOpen = true; card.classList.add('interactive'); clickHint.classList.add('show'); }, 7500);
        };

        function createSparkles() {
            setInterval(() => {
                const sparkle = document.createElement('div');
                sparkle.classList.add('sparkle');
                const x = Math.random() * 700 - 100; 
                const y = Math.random() * 500 - 50;
                const size = Math.random() * 4 + 2; 
                sparkle.style.left = x + 'px'; sparkle.style.top = y + 'px';
                sparkle.style.width = size + 'px'; sparkle.style.height = size + 'px';
                const duration = Math.random() * 2 + 2; 
                sparkle.style.animation = `sparkleFloat ${duration}s linear forwards`;
                if (Math.random() > 0.7) { sparkle.style.background = '#f1dfa8'; sparkle.style.boxShadow = '0 0 10px #f1dfa8'; }
                sparkleContainer.appendChild(sparkle);
                setTimeout(() => { sparkle.remove(); }, duration * 1000);
            }, 150);
        }
        createSparkles();

        card.addEventListener('click', function () {
            if (!canOpen) return;
            wrapper.classList.add('opening');
            card.classList.add('open');

            setTimeout(() => {
                card.style.opacity = '0';
                wrapper.style.display = 'none';
                box.style.zIndex = '50';
                box.style.opacity = '1'; 

                // â˜…â˜…â˜… æ–°æ–‡æœ¬å…§å®¹ (ç´”ç™½æ–‡å­—ï¼Œç„¡ç‰¹æ®Šé¡è‰²æ¨™è¨˜) â˜…â˜…â˜…
                let str = 'æ¥Šé›…ç¾½ å¥³ä¿  è‡ºé‘’ï¼šÂ§'+
                'çƒ½ç«é€£ä¸‰æœˆï¼Œå®¶æ›¸æŠµè¬é‡‘ã€‚Â§'+
                'æ­²æœˆä¸å±…ï¼Œè½‰ç¬åŠè¼‰ã€‚ä»Šä¿®æ›¸ä¸€å°ï¼Œéç‚ºéºè¨€ï¼Œä¹ƒå ±å¹³å®‰ï¼šå¾èº«å¼·é«”å¥ï¼Œæœªè¢«æŒ¯åˆ€éœ‡ç¢å¿ƒè„ˆï¼Œäº¦æœªè¢«æ¯’åœˆæ¯’ç™¼èº«äº¡ï¼Œå°šèƒ½å†æˆ°ä¸‰ç™¾å›åˆï¼Â§'+
                'å›é¦–å‰å¡µï¼Œå¦³æˆ‘äºŒäººæ–¼è™›æ“¬æ±Ÿæ¹–æ­·ç·´ï¼Œæˆ°ç¸¾å½ªç‚³ã€‚Â§'+
                'é›–æ›¾æ¶‰çµä¸‰è§’æ´²ä¹‹æ§ç«ï¼Œäº¦æ›¾éŠæ­·ç„¡äººæ·±ç©ºä¹‹æµ©æ¸ºï¼Œå¶çˆ¾äº¦ä½œçŸ¥åªä¹‹æ†¨æ…‹ã€‚Â§'+
                'ç„¶è«–åŠåˆ»éª¨éŠ˜å¿ƒï¼Œå”¯æœ‰æ°¸åŠ«ç„¡é–“ã€‚Â§'+
                'è¨˜å¦ï¼Ÿçµ•å¢ƒä¹‹ä¸­ï¼Œäº’ç›¸æ‰¶æŒï¼›äº‚æˆ°ä¹‹å…§ï¼Œé»˜å¥‘é…åˆã€‚Â§'+
                'æ¯ä¸€æ¬¡æŒ¯åˆ€ä¹‹æ¸…è„†ï¼Œæ¯ä¸€æ¬¡é‰¤ç´¢ä¹‹é£›æ¸¡ï¼Œçš†æ˜¯ä½ æˆ‘æƒ…èª¼ä¹‹è¦‹è­‰ã€‚Â§'+
                'ç´…å¡µæ»¾æ»¾ï¼Œç¶²æµ·èŒ«èŒ«ï¼Œèƒ½é‡ä¸€é »ç‡ç›¸åŒä¹‹æˆ°å‹ï¼Œå¯¦ä¹ƒå¾ä¹‹å¤§å¹¸ã€‚Â§'+
                'ï¼ˆå—¶â€”â€”ï¼ç³»çµ±è­¦å‘Šï¼šæ‚¨çš„ã€Œæ–‡è¨€æ–‡è£é€¼é¡åº¦ã€å·²è€—ç›¡ï¼Œæ­£åœ¨å¼·åˆ¶åˆ‡æ›å›äººé¡èªè¨€...ï¼‰Â§'+
                'å¥½å•¦ï¼Œç©ç¬‘æ­¸ç©ç¬‘ï¼Œé‚„æ˜¯åœ¨é€™è£¡å…ˆç¥ä½ ç”Ÿæ—¥å¿«æ¨‚ï¼ğŸ‚Â§'+
                'è¶è‘—é€™å€‹ç‰¹åˆ¥çš„æ—¥å­ï¼ŒæŠŠé‚£äº›æ–‡ç¸ç¸çš„å°è©æ‹‹é–‹ï¼ŒèªçœŸè·Ÿå¦³èŠå…©å¥ã€‚Â§'+
                'å›é ­çœ‹é€™åŠå¹´ï¼Œæ™‚é–“çœŸçš„éå¾—è¶…ç´šå¿«ã€‚é›–ç„¶æˆ‘å€‘ä¹Ÿç©äº†ä¸å°‘å…¶ä»–éŠæˆ²ï¼Œä½†å›æ†¶æœ€æ·±ã€ç¬‘å¾—æœ€å¤§è²çš„ï¼Œæœç„¶é‚„æ˜¯æ°¸åŠ«ç„¡é–“ã€‚Â§'+
                'é‚£äº›å¿ƒè·³åŠ é€Ÿçš„æ±ºè³½åœˆï¼Œé‚„æœ‰æˆ‘å€‘è¢«å°é¢å¤§ä½›æŠ“èµ·ä¾†çš„æ—¥å­ï¼Œç¾åœ¨æƒ³èµ·ä¾†éƒ½å¾ˆæœ‰ç•«é¢ã€‚Â§'+
                'æˆ‘å¾ˆæ…¶å¹¸èƒ½é‡åˆ°å¦³é€™æ¨£çš„å¥½éšŠå‹ï¼Œè„¾æ°£å¥½åˆç©å¾—ä¾†ã€‚è·Ÿå¦³æ‰“éŠæˆ²ä¸ç”¨æœ‰ä»€éº¼åŒ…è¢±ï¼Œä¸éœ€è¦ç‚ºäº†æ‰åˆ†è€Œå£“åŠ›å±±å¤§ã€‚è´äº†æˆ‘å€‘å°±äº’å¹ä¸€æ³¢æ“ä½œï¼Œè¼¸äº†å°±ä¸€èµ·åæ§½å°é¢æ˜¯è€å…­ï¼Œé€™ç¨®æ„Ÿè¦ºçœŸçš„å¾ˆæ”¾é¬†ã€‚Â§'+
                'è¬è¬å¦³ç¸½æ˜¯èƒ½æ¥ä½æˆ‘çš„æ¢—ï¼Œä¹ŸåŒ…å®¹æˆ‘æœ‰æ™‚å€™çš„çæ“ä½œã€‚Â§'+
                'æ–°çš„ä¸€æ­²ï¼Œç¥å¦³åœ¨ç¾å¯¦ç”Ÿæ´»ä¸­ä¹Ÿåƒåœ¨éŠæˆ²è£¡ä¸€æ¨£å¼·å¤§ï¼Œç”Ÿæ´»è£¡æ²’æœ‰è€å…­ï¼Œåªæœ‰é©šå–œï¼Â§'+
                '^2026å¹´1æœˆ21æ—¥Â§'+
                '^å…¨æœç¬¬ä¸€å¸¥ å¸¥å“¥é˜¿è«¾ é “é¦–';
                
                let i = 0;
                let strp = '<p class="recipient-name">'; 

                function print() {
                    // â˜…â˜…â˜… è‡ªå‹•æ²å‹•ï¼šæ¯æ¬¡å°å­—éƒ½ç¢ºä¿æ²è»¸åœ¨æœ€ä¸‹æ–¹ â˜…â˜…â˜…
                    box.scrollTo(0, box.scrollHeight);

                    if (str[i] == 'Â§') {
                        document.getElementById("box").innerHTML = strp + "</p><p>" + (i < str.length - 1 ? '|' : ''); 
                        strp += "</p><p>";
                        i++;
                    } 
                    else if (str[i] == '^') {
                        let rightHtml = '</p><p class="right-align">';
                        document.getElementById("box").innerHTML = strp + rightHtml + (i < str.length - 1 ? '|' : '');
                        strp += rightHtml;
                        i++;
                    }
                    else {
                        strp += str[i];
                        document.getElementById("box").innerHTML = strp + (i < str.length - 1 ? '|' : '');
                        i++;
                    }
                }

                setTimeout(() => {
                    if (typingSound) {
                        typingSound.currentTime = 0; 
                        typingSound.volume = 0.5;    
                        typingSound.play().catch(e => console.log("éŸ³æ•ˆæ’­æ”¾å¤±æ•—", e));
                    }

                    let printid = setInterval(() => {
                        if (i >= str.length) {
                            clearInterval(printid);
                            if (typingSound) typingSound.pause();
                            // ç¢ºä¿æœ€å¾Œå†æ²å‹•ä¸€æ¬¡
                            setTimeout(() => box.scrollTo(0, box.scrollHeight), 100);
                            showBonusButton();
                        } else {
                            print();
                        }
                    }, 150); 
                }, 1500); 

            }, 2200); 
        });

        function showBonusButton() {
            let btnContainer = document.createElement("div");
            btnContainer.style.marginTop = "70px"; 
            btnContainer.style.textAlign = "center";
            btnContainer.style.width = "100%";
            btnContainer.style.opacity = "0"; 
            btnContainer.style.transform = "translateY(20px)";
            btnContainer.style.filter = "blur(10px)";
            btnContainer.style.transition = "opacity 4s ease-in-out, transform 4s ease-out, filter 4s ease-out";
            btnContainer.style.flexShrink = "0"; 

            let btn = document.createElement("div");
            btn.innerText = "âœ¨ ç¥ç§˜æŒ‰éˆ• âœ¨"; 
            btn.className = "next-chapter-btn"; 
            btn.addEventListener('click', fadeOutAndNavigate);

            btnContainer.appendChild(btn);
            box.appendChild(btnContainer);
            
            // ç¢ºä¿æŒ‰éˆ•åŠ å…¥å¾Œï¼Œç•«é¢ä¹Ÿæ²å‹•åˆ°åº•éƒ¨
            setTimeout(() => box.scrollTo({ top: box.scrollHeight, behavior: 'smooth' }), 100);
            
            setTimeout(() => { 
                btnContainer.style.opacity = "1"; 
                btnContainer.style.transform = "translateY(0)";
                btnContainer.style.filter = "blur(0)";
            }, 10000);
        }

        function fadeOutAndNavigate(e) {
            e.preventDefault(); 
            whiteFlash.style.display = 'block';
            void whiteFlash.offsetWidth; 
            whiteFlash.style.transition = "opacity 3s ease-in";
            whiteFlash.style.opacity = "1";
            
            if (bgm) {
                const duration = 3000; 
                const steps = 30; 
                const intervalTime = duration / steps;
                const volStep = bgm.volume / steps;
                const fadeAudio = setInterval(() => {
                    if (bgm.volume > volStep) { bgm.volume -= volStep; } 
                    else { bgm.volume = 0; bgm.pause(); clearInterval(fadeAudio); }
                }, intervalTime);
            }
            setTimeout(() => { window.location.href = "test5.html"; }, 3000);
        }
    </script>
</body>
</html>